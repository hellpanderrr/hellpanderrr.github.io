/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/easy-speech@2.3.1/dist/EasySpeech.iife.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var EasySpeech=function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach((function(e){n(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,c,a=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(u)throw i}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=["text","voice","pitch","rate","volume","force","infiniteResume"],a={},s="undefined"==typeof globalThis?window:globalThis,u={status:"created"},l={};a.debug=function(e){f="function"==typeof e?e:function(){}};var f=function(){};a.detect=function(){return v()};var v=function(){var e={};["speechSynthesis","speechSynthesisUtterance","speechSynthesisVoice","speechSynthesisEvent","speechSynthesisErrorEvent"].forEach((function(t){e[t]=S(t)})),e.onvoiceschanged=d(e.speechSynthesis,"onvoiceschanged");var t=d(e.speechSynthesisUtterance,"prototype");return j.forEach((function(n){var r="on".concat(n);e[r]=t&&d(e.speechSynthesisUtterance.prototype,r)})),l.isAndroid=p(),l.isFirefox=m()||y(),l.isSafari=g(),f("is android: ".concat(!!l.isAndroid)),f("is firefox: ".concat(!!l.isFirefox)),f("is safari: ".concat(!!l.isSafari)),e},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object.hasOwnProperty.call(e,t)||t in e||!!e[t]},h=function(){return(s.navigator||{}).userAgent||""},p=function(){return/android/i.test(h())},y=function(){return/kaios/i.test(h())},m=function(){return void 0!==s.InstallTrigger||/firefox/i.test(h())},g=function(){return void 0!==s.GestureEvent},b=["webKit","moz","ms","o"],S=function(e){var t,n="".concat((t=e).charAt(0).toUpperCase()).concat(t.slice(1)),r=b.map((function(e){return"".concat(e).concat(n)})),i=[e,n].concat(r).find(w);return s[i]},w=function(e){return s[e]};a.status=function(){return t({},u)},a.filterVoices=function(e){var t=e.name,n=e.language,r=e.localService,i=e.voiceURI,o=u.voices||[],c=void 0!==t,a=void 0!==i,s=void 0!==r,l=void 0!==n,f=l&&n.split(/[-_]+/g)[0].toLocaleLowerCase();return o.filter((function(e){if(c&&e.name.includes(t)||a&&e.voiceURI.includes(i)||s&&e.localService===r)return!0;if(l){var n=e.lang&&e.lang.toLocaleLowerCase();return n&&(n===f||n.indexOf("".concat(f,"-"))>-1||n.indexOf("".concat(f,"_"))>-1)}return!1}))};var E=function(e){f(e),u.status=e};a.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.maxTimeout,n=void 0===t?5e3:t,r=e.interval,i=void 0===r?250:r,o=e.quiet,c=e.maxLengthExceeded;return new Promise((function(e,t){if(u.initialized)return e(!1);var r,l;a.reset(),E("init: start");var f=!1;u.maxLengthExceeded=c||"warn";var h=function(n){return E("init: failed (".concat(n,")")),clearInterval(r),u.initialized=!1,o?e(!1):t(new Error("EasySpeech: ".concat(n)))},p=function(){if(!f)return E("init: complete"),f=!0,u.initialized=!0,clearInterval(r),m.onvoiceschanged=null,l&&m.removeEventListener("voiceschanged",l),e(!0)},y=v();if(!(!!y.speechSynthesis&&!!y.speechSynthesisUtterance))return h("browser misses features");Object.keys(y).forEach((function(e){u[e]=y[e]}));var m=u.speechSynthesis,g=function(){var e=m.getVoices()||[];if(e.length>0){if(u.voices=e,E("voices loaded: ".concat(e.length)),u.defaultVoice=e.find((function(e){return e.default})),!u.defaultVoice){var t=(s.navigator||{}).language||"",n=a.filterVoices({language:t});n.length>0&&(u.defaultVoice=n[0])}return u.defaultVoice||(u.defaultVoice=e[0]),!0}return!1};if(E("init: voices"),g())return p();var b=function(){E("init: voices (timer)");var e=0;r=setInterval((function(){return g()?p():e>n?h("browser has no voices (timeout)"):void(e+=i)}),i)};y.onvoiceschanged?(E("init: voices (onvoiceschanged)"),m.onvoiceschanged=function(){return g()?p():b()},setTimeout((function(){return g()?p():h("browser has no voices (timeout)")}),n)):(d(m,"addEventListener")&&(E("init: voices (addEventListener)"),l=function(){if(g())return p()},m.addEventListener("voiceschanged",l)),b())}))};var O=function(){if(!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).force&&!u.initialized)throw new Error("EasySpeech: not initialized. Run EasySpeech.init() first")};a.voices=function(){return O(),u.voices},a.on=function(e){return O(),j.forEach((function(t){var n=e[t];x.handler(n)&&(u.handlers[t]=n)})),t({},u.handlers)};var j=["boundary","end","error","mark","pause","resume","start"],x={isNumber:function(e){return"number"==typeof e&&!Number.isNaN(e)},pitch:function(e){return x.isNumber(e)&&e>=0&&e<=2},volume:function(e){return x.isNumber(e)&&e>=0&&e<=1},rate:function(e){return x.isNumber(e)&&e>=.1&&e<=10},text:function(e){return"string"==typeof e},handler:function(e){return"function"==typeof e},voice:function(e){return e&&e.lang&&e.name&&e.voiceURI}};a.defaults=function(e){return O(),e&&(u.defaults=u.defaults||{},["voice","pitch","rate","volume"].forEach((function(t){var n=e[t];(0,x[t])(n)&&(u.defaults[t]=n)}))),t({},u.defaults)};a.speak=function(e){var t=e.text,n=e.voice,o=e.pitch,a=e.rate,s=e.volume,f=e.force,v=e.infiniteResume,d=r(e,c);if(O({force:f}),!x.text(t))throw new Error("EasySpeech: at least some valid text is required to speak");if((new TextEncoder).encode(t).length>4096){var h="EasySpeech: text exceeds max length of 4096 bytes, which will not work with some voices.";switch(u.maxLengthExceeded){case"none":break;case"error":throw new Error(h);default:console.warn(h)}}var p=function(e){var t,n=i(Object.entries(e)[0],2),r=n[0],o=n[1];return x[r](o)?o:null===(t=u.defaults)||void 0===t?void 0:t[r]};return new Promise((function(e,r){E("init speak");var i=function(e){return new(0,u.speechSynthesisUtterance)(e)}(t),c=function(e){var t,n;return e||(null===(t=u.defaults)||void 0===t?void 0:t.voice)||u.defaultVoice||(null===(n=u.voices)||void 0===n?void 0:n[0])}(n);c&&(i.voice=c,i.lang=c.lang,i.voiceURI=c.voiceURI),i.text=t,i.pitch=p({pitch:o}),i.rate=p({rate:a}),i.volume=p({volume:s});var f=i.voice&&i.voice.name&&i.voice.name.toLocaleLowerCase().includes("(natural)");L(i,{isMsNatural:f}),j.forEach((function(e){var t,n=d[e];x.handler(n)&&i.addEventListener(e,n),null!==(t=u.handlers)&&void 0!==t&&t[e]&&i.addEventListener(e,u.handlers[e])})),i.addEventListener("start",(function(){l.paused=!1,l.speaking=!0;var e=!f&&!l.isFirefox&&!l.isSafari&&!0!==l.isAndroid;("boolean"==typeof v?v:e)&&P(i)})),i.addEventListener("end",(function(t){E("speak complete"),l.paused=!1,l.speaking=!1,clearTimeout(k),e(t)})),i.addEventListener("error",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};E("speak failed: ".concat(e.message)),l.paused=!1,l.speaking=!1,clearTimeout(k),r(e)})),clearTimeout(k),u.speechSynthesis.cancel(),setTimeout((function(){return u.speechSynthesis.speak(i)}),10)}))};var k,L=function(e){var t=e.voice,n=e.pitch,r=e.rate,i=e.volume,o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).isMsNatural,c=void 0!==o&&o;f("utterance: voice=".concat(null==t?void 0:t.name," volume=").concat(i," rate=").concat(r," pitch=").concat(n," isMsNatural=").concat(c))};function P(e){if(!e&&k)return f("force-clear timeout"),s.clearTimeout(k);var t=u.speechSynthesis,n=t.paused,r=t.speaking||l.speaking,i=n||l.paused;f("resumeInfinity isSpeaking=".concat(r," isPaused=").concat(i)),r&&!i&&(u.speechSynthesis.pause(),u.speechSynthesis.resume()),k=s.setTimeout((function(){P(e)}),5e3)}return a.cancel=function(){O(),E("cancelling"),u.speechSynthesis.cancel(),l.paused=!1,l.speaking=!1},a.resume=function(){O(),E("resuming"),l.paused=!1,l.speaking=!0,u.speechSynthesis.resume()},a.pause=function(){if(O(),E("pausing"),l.isAndroid)return f("patch pause on Android with cancel"),u.speechSynthesis.cancel();u.speechSynthesis.pause(),l.paused=!0,l.speaking=!1},a.reset=function(){Object.assign(u,{status:"reset",initialized:!1,speechSynthesis:null,speechSynthesisUtterance:null,speechSynthesisVoice:null,speechSynthesisEvent:null,speechSynthesisErrorEvent:null,voices:null,defaultVoice:null,defaults:{pitch:1,rate:1,volume:1,voice:null},handlers:{}})},a}();
//# sourceMappingURL=/sm/05fb173ac53cc82eb4bb112cdd3283e2db6ea136a7bbc49d44e0e4eb0dd5484d.map